# è®¾è®¡é™¢æ–‡æ¡£è‡ªåŠ¨å¡«å†™IOç‚¹è¡¨åŠŸèƒ½å¼€å‘è®¡åˆ’

## åŠŸèƒ½æ¦‚è¿°
å¼€å‘ä¸€ä¸ªå®Œæ•´çš„å·¥ä½œæµç¨‹ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡è®¾è®¡é™¢Wordæ–‡æ¡£è‡ªåŠ¨å¡«å†™IOç‚¹è¡¨æ¨¡æ¿çš„ç°è‰²é«˜äº®éƒ¨åˆ†ï¼Œå®ç°ä»æ–‡æ¡£è§£æåˆ°é€šé“åˆ†é…å†åˆ°æ¨¡æ¿è‡ªåŠ¨å¡«å†™çš„ç«¯åˆ°ç«¯è§£å†³æ–¹æ¡ˆã€‚

## æ ¸å¿ƒéœ€æ±‚é‡æ–°å®šä¹‰
1. **æ–‡æ¡£è§£æ**ï¼šè§£æè®¾è®¡é™¢Wordæ–‡æ¡£ï¼Œæå–ä»ªè¡¨ä½å·ã€æè¿°ã€ä¿¡å·ç±»å‹ç­‰ä¿¡æ¯
2. **é€šé“åˆ†é…ç•Œé¢**ï¼šæä¾›äº¤äº’ç•Œé¢è®©ç”¨æˆ·æ‰‹åŠ¨åˆ†é…æ¯ä¸ªç‚¹ä½åˆ°å…·ä½“PLCé€šé“
3. **æ¨¡æ¿è‡ªåŠ¨å¡«å†™**ï¼šæ ¹æ®é€šé“åˆ†é…ç»“æœï¼Œè‡ªåŠ¨å¡«å†™IOç‚¹è¡¨æ¨¡æ¿çš„ç°è‰²éƒ¨åˆ†
4. **æ•°æ®ç®¡ç†**ï¼šæ”¯æŒåˆ†é…æ–¹æ¡ˆçš„ä¿å­˜ã€åŠ è½½å’Œç®¡ç†

## ç”¨æˆ·å·¥ä½œæµç¨‹
```
1. æ‹–æ‹½Wordæ–‡æ¡£ â†’ è§£æç‚¹ä½æ•°æ®
2. è¿›å…¥é€šé“åˆ†é…ç•Œé¢ â†’ äººå·¥åˆ†é…æ¯ä¸ªç‚¹ä½åˆ°å…·ä½“é€šé“
3. ä¿å­˜åˆ†é…æ–¹æ¡ˆ
4. ç”ŸæˆIOç‚¹è¡¨æ—¶é€‰æ‹©ä½¿ç”¨åˆ†é…æ–¹æ¡ˆ â†’ è‡ªåŠ¨å¡«å†™ç°è‰²éƒ¨åˆ†
```

## æŠ€æœ¯æ¶æ„

### 1. æ–‡æ¡£è§£ææ¨¡å— (`core/document_parser/`) âœ… å·²å®Œæˆ
- **word_parser.py**: Wordæ–‡æ¡£è§£æå™¨
- **smart_header_detector.py**: æ™ºèƒ½è¡¨å¤´æ£€æµ‹å™¨
- **data_enhancer.py**: æ•°æ®å¢å¼ºå¤„ç†å™¨

### 2. é€šé“åˆ†é…æ¨¡å— (`core/channel_assignment/`) ğŸ†• æ–°å¢
- **assignment_manager.py**: åˆ†é…æ–¹æ¡ˆç®¡ç†å™¨
- **channel_provider.py**: å¯ç”¨é€šé“æä¾›å™¨
- **assignment_validator.py**: åˆ†é…ç»“æœéªŒè¯å™¨

### 3. æ•°æ®å­˜å‚¨æ¨¡å— (`core/data_storage/`) ğŸ†• æ–°å¢
- **parsed_data_dao.py**: è§£ææ•°æ®è®¿é—®å¯¹è±¡
- **assignment_dao.py**: åˆ†é…æ–¹æ¡ˆè®¿é—®å¯¹è±¡
- **data_models.py**: æ•°æ®æ¨¡å‹å®šä¹‰

### 4. ç”¨æˆ·ç•Œé¢æ¨¡å— (`ui/components/`)
- **document_import_widget.py**: æ–‡æ¡£å¯¼å…¥ç•Œé¢ âœ… å·²å®Œæˆ
- **channel_assignment_widget.py**: é€šé“åˆ†é…ç•Œé¢ ğŸ†• æ–°å¢
- **assignment_preview_widget.py**: åˆ†é…é¢„è§ˆç»„ä»¶ ğŸ†• æ–°å¢

### 5. IOç‚¹è¡¨é›†æˆæ¨¡å— (`core/io_table/`)
- **excel_exporter.py**: ä¿®æ”¹ç°æœ‰å¯¼å‡ºå™¨ï¼Œæ”¯æŒè‡ªåŠ¨å¡«å†™ ğŸ”„ éœ€ä¿®æ”¹
- **template_filler.py**: æ¨¡æ¿è‡ªåŠ¨å¡«å†™å™¨ ğŸ†• æ–°å¢

## å¼€å‘é˜¶æ®µ

### ç¬¬ä¸€é˜¶æ®µï¼šæ–‡æ¡£è§£æåŠŸèƒ½ âœ… å·²å®Œæˆ
**ç›®æ ‡**ï¼šå®ç°Wordæ–‡æ¡£è§£æå’Œæ•°æ®æå–
- [x] Wordæ–‡æ¡£è§£æå™¨
- [x] æ™ºèƒ½è¡¨å¤´æ£€æµ‹
- [x] æ•°æ®å¢å¼ºå’Œæ ‡å‡†åŒ–

### ç¬¬äºŒé˜¶æ®µï¼šæ•°æ®å­˜å‚¨å’Œç®¡ç† ğŸ¯ å½“å‰é˜¶æ®µ
**ç›®æ ‡**ï¼šå»ºç«‹è§£ææ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨
- [ ] è®¾è®¡æ•°æ®æ¨¡å‹å’Œæ•°æ®åº“è¡¨ç»“æ„
- [ ] å®ç°è§£ææ•°æ®çš„CRUDæ“ä½œ
- [ ] å»ºç«‹åˆ†é…æ–¹æ¡ˆçš„å­˜å‚¨æœºåˆ¶

**äº¤ä»˜ç‰©**ï¼š
- è§£ææ•°æ®æŒä¹…åŒ–å­˜å‚¨
- åˆ†é…æ–¹æ¡ˆç®¡ç†åŠŸèƒ½
- æ•°æ®æŸ¥è¯¢å’Œæ£€ç´¢æ¥å£

### ç¬¬ä¸‰é˜¶æ®µï¼šé€šé“åˆ†é…ç•Œé¢ ğŸ¯ æ ¸å¿ƒåŠŸèƒ½
**ç›®æ ‡**ï¼šåˆ›å»ºäº¤äº’å¼é€šé“åˆ†é…ç•Œé¢
- [ ] è®¾è®¡é€šé“åˆ†é…UIå¸ƒå±€
- [ ] å®ç°æ‹–æ‹½åˆ†é…åŠŸèƒ½
- [ ] æ·»åŠ æ™ºèƒ½åˆ†é…è¾…åŠ©
- [ ] å®ç°åˆ†é…ç»“æœéªŒè¯

**ç•Œé¢è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   è§£æçš„ç‚¹ä½    â”‚    åˆ†é…æ“ä½œ     â”‚   å¯ç”¨é€šé“      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ PT-1102       â”‚                 â”‚ â–¡ AI-01         â”‚
â”‚   å‹åŠ›æ£€æµ‹      â”‚   [åˆ†é…] â†’      â”‚ â–¡ AI-02         â”‚
â”‚   AIç±»å‹        â”‚                 â”‚ â–¡ AI-03         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¡ TT-1101       â”‚                 â”‚ â–¡ DI-01         â”‚
â”‚   æ¸©åº¦æ£€æµ‹      â”‚   [åˆ†é…] â†’      â”‚ â–¡ DI-02         â”‚
â”‚   AIç±»å‹        â”‚                 â”‚ â–¡ DI-03         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº¤ä»˜ç‰©**ï¼š
- å®Œæ•´çš„é€šé“åˆ†é…ç•Œé¢
- æ‹–æ‹½åˆ†é…åŠŸèƒ½
- åˆ†é…å†²çªæ£€æµ‹å’Œæé†’

### ç¬¬å››é˜¶æ®µï¼šIOç‚¹è¡¨é›†æˆ ğŸ¯ æœ€ç»ˆç›®æ ‡
**ç›®æ ‡**ï¼šä¿®æ”¹ç°æœ‰IOç‚¹è¡¨å¯¼å‡ºåŠŸèƒ½ï¼Œæ”¯æŒè‡ªåŠ¨å¡«å†™
- [ ] ä¿®æ”¹PLCSheetExporterç±»
- [ ] å®ç°ä»åˆ†é…æ•°æ®è‡ªåŠ¨å¡«å†™ç°è‰²å­—æ®µ
- [ ] åœ¨IOç‚¹è¡¨ç•Œé¢æ·»åŠ "ä½¿ç”¨åˆ†é…æ•°æ®"é€‰é¡¹

**è‡ªåŠ¨å¡«å†™çš„å­—æ®µ**ï¼š
- **é€šé“ä½å·**ï¼šæ ¹æ®åˆ†é…ç»“æœå¡«å†™ï¼ˆå¦‚AI-01ï¼‰
- **å˜é‡åç§°ï¼ˆHMIï¼‰**ï¼šä½¿ç”¨è§£æçš„instrument_tag
- **å˜é‡æè¿°**ï¼šä½¿ç”¨è§£æçš„description
- **å•ä½**ï¼šä½¿ç”¨è§£æçš„units
- **é‡ç¨‹ä½é™/é«˜é™**ï¼šä»è§£æçš„data_rangeæå–
- **ä¾›ç”µç±»å‹**ï¼šä»è§£æçš„power_supplyæ¨æ–­
- **çº¿åˆ¶**ï¼šä»ä¿¡å·ç±»å‹æ¨æ–­

**äº¤ä»˜ç‰©**ï¼š
- ä¿®æ”¹åçš„IOç‚¹è¡¨å¯¼å‡ºåŠŸèƒ½
- è‡ªåŠ¨å¡«å†™ç°è‰²å­—æ®µçš„é€»è¾‘
- å®Œæ•´çš„ç«¯åˆ°ç«¯å·¥ä½œæµç¨‹

### ç¬¬äº”é˜¶æ®µï¼šåŠŸèƒ½å®Œå–„å’Œä¼˜åŒ–
**ç›®æ ‡**ï¼šå®Œå–„ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿç¨³å®šæ€§
- [ ] æ·»åŠ æ‰¹é‡åˆ†é…åŠŸèƒ½
- [ ] å®ç°åˆ†é…æ¨¡æ¿å’Œè§„åˆ™
- [ ] ä¼˜åŒ–ç•Œé¢äº¤äº’ä½“éªŒ
- [ ] æ·»åŠ æ•°æ®å¯¼å…¥å¯¼å‡ºåŠŸèƒ½

## å…³é”®æŠ€æœ¯å®ç°

### 1. é€šé“åˆ†é…ç®—æ³•
```python
class ChannelAssignmentManager:
    def assign_channel(self, point_data, channel_id):
        """åˆ†é…ç‚¹ä½åˆ°æŒ‡å®šé€šé“"""
        
    def auto_assign_by_type(self, points, start_channel):
        """æŒ‰ç±»å‹è‡ªåŠ¨åˆ†é…é€šé“"""
        
    def validate_assignment(self, assignment):
        """éªŒè¯åˆ†é…ç»“æœçš„åˆæ³•æ€§"""
```

### 2. æ¨¡æ¿è‡ªåŠ¨å¡«å†™
```python
class TemplateFiller:
    def fill_from_assignment(self, assignment_data):
        """æ ¹æ®åˆ†é…æ•°æ®å¡«å†™æ¨¡æ¿"""
        
    def extract_range_values(self, data_range):
        """ä»æ•°æ®èŒƒå›´æå–ä½é™é«˜é™"""
        
    def infer_power_type(self, power_supply):
        """æ¨æ–­ä¾›ç”µç±»å‹"""
```

### 3. æ•°æ®æŒä¹…åŒ–
```python
class ParsedDataDAO:
    def save_parsed_data(self, project_id, parsed_points):
        """ä¿å­˜è§£ææ•°æ®"""
        
    def get_parsed_data(self, project_id):
        """è·å–è§£ææ•°æ®"""

class AssignmentDAO:
    def save_assignment(self, assignment_scheme):
        """ä¿å­˜åˆ†é…æ–¹æ¡ˆ"""
        
    def load_assignment(self, scheme_id):
        """åŠ è½½åˆ†é…æ–¹æ¡ˆ"""
```

## æ•°æ®æ¨¡å‹è®¾è®¡

### è§£ææ•°æ®æ¨¡å‹
```python
@dataclass
class ParsedPoint:
    id: str
    project_id: str
    instrument_tag: str
    description: str
    signal_type: str
    io_type: str
    units: str
    data_range: str
    power_supply: str
    created_at: datetime
```

### åˆ†é…æ–¹æ¡ˆæ¨¡å‹
```python
@dataclass
class ChannelAssignment:
    id: str
    project_id: str
    scheme_name: str
    assignments: List[PointChannelMapping]
    created_at: datetime

@dataclass
class PointChannelMapping:
    point_id: str
    channel_id: str
    channel_type: str  # AI, DI, AO, DO
    assigned_at: datetime
```

## æˆåŠŸæ ‡å‡†

### åŠŸèƒ½æ ‡å‡†
- [ ] æ”¯æŒ100+ç‚¹ä½çš„é€šé“åˆ†é…æ“ä½œ
- [ ] è‡ªåŠ¨å¡«å†™å‡†ç¡®ç‡è¾¾åˆ°95%ä»¥ä¸Š
- [ ] å®Œæ•´çš„æ•°æ®ç®¡ç†å’Œæ–¹æ¡ˆä¿å­˜åŠŸèƒ½

### æ€§èƒ½æ ‡å‡†
- [ ] é€šé“åˆ†é…ç•Œé¢å“åº”æ—¶é—´<1ç§’
- [ ] æ¨¡æ¿è‡ªåŠ¨å¡«å†™æ—¶é—´<10ç§’
- [ ] æ”¯æŒå¤šä¸ªé¡¹ç›®å¹¶å‘æ“ä½œ

### ç”¨æˆ·ä½“éªŒæ ‡å‡†
- [ ] ç›´è§‚çš„æ‹–æ‹½åˆ†é…ç•Œé¢
- [ ] æ¸…æ™°çš„åˆ†é…è¿›åº¦å’ŒçŠ¶æ€æç¤º
- [ ] å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ’¤é”€åŠŸèƒ½

## é£é™©è¯„ä¼°å’Œç¼“è§£

### é«˜é£é™©
- **é€šé“å†²çª**ï¼šå¤šä¸ªç‚¹ä½åˆ†é…åˆ°åŒä¸€é€šé“
  - ç¼“è§£ï¼šå®æ—¶å†²çªæ£€æµ‹å’Œæé†’
- **æ•°æ®ä¸€è‡´æ€§**ï¼šåˆ†é…æ•°æ®ä¸å®é™…ç¡¬ä»¶ä¸ç¬¦
  - ç¼“è§£ï¼šä¸¥æ ¼çš„æ•°æ®éªŒè¯å’Œç”¨æˆ·ç¡®è®¤

### ä¸­é£é™©
- **ç•Œé¢å¤æ‚æ€§**ï¼šé€šé“åˆ†é…ç•Œé¢å¯èƒ½è¿‡äºå¤æ‚
  - ç¼“è§£ï¼šåˆ†æ­¥éª¤å¼•å¯¼å’Œæ™ºèƒ½é»˜è®¤å€¼
- **æ€§èƒ½é—®é¢˜**ï¼šå¤§é‡ç‚¹ä½çš„åˆ†é…æ“ä½œå¯èƒ½è¾ƒæ…¢
  - ç¼“è§£ï¼šåˆ†é¡µåŠ è½½å’Œå¼‚æ­¥å¤„ç†

## åç»­ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸä¼˜åŒ–
- æ™ºèƒ½åˆ†é…ç®—æ³•ä¼˜åŒ–
- åˆ†é…æ¨¡æ¿å’Œè§„åˆ™å¼•æ“
- æ‰¹é‡æ“ä½œåŠŸèƒ½å¢å¼º

### é•¿æœŸè§„åˆ’
- AIè¾…åŠ©çš„æ™ºèƒ½åˆ†é…å»ºè®®
- ä¸ç¡¬ä»¶é…ç½®çš„å®æ—¶åŒæ­¥
- åˆ†é…æ–¹æ¡ˆçš„ç‰ˆæœ¬æ§åˆ¶å’Œåä½œ
