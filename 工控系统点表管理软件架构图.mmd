graph TB
    subgraph "用户界面层 (UI Layer)"
        A1[主窗口 MainWindow]
        A2[登录界面 LoginDialog]
        A3[项目管理界面 ProjectArea]
        A4[设备管理界面 DeviceArea]
        A5[第三方设备配置界面 ThirdPartyDeviceArea]
        A6[通道分配界面 ChannelAssignmentWidget]
        A7[查询区域 QueryArea]
        A8[状态栏 StatusBar]
    end
    
    subgraph "业务逻辑层 (Business Logic Layer)"
        B1[用户管理服务 UserService]
        B2[权限管理服务 PermissionService]
        B3[项目管理服务 ProjectService]
        B4[设备管理服务 DeviceService]
        B5[第三方设备服务 ThirdPartyDeviceService]
        B6[IO点表处理服务 IOTableService]
        B7[通道分配服务 ChannelAssignmentService]
        B8[点表生成服务 TableGenerationService]
    end
    
    subgraph "数据处理层 (Data Processing Layer)"
        C1[文件解析器 FileParser]
        C2[数据验证器 DataValidator]
        C3[数据转换器 DataConverter]
        C4[智能分配引擎 SmartAssignmentEngine]
        C5[点表生成器 TableGenerator]
        C6[模板填写器 TemplateFiller]
    end
    
    subgraph "数据访问层 (Data Access Layer)"
        D1[用户数据访问 UserDAO]
        D2[项目数据访问 ProjectDAO]
        D3[设备数据访问 DeviceDAO]
        D4[模板数据访问 TemplateDAO]
        D5[分配数据访问 AssignmentDAO]
        D6[解析数据访问 ParsedDataDAO]
    end
    
    subgraph "数据存储层 (Data Storage Layer)"
        E1[用户数据库 UserDB]
        E2[项目数据库 ProjectDB]
        E3[配置文件 ConfigFiles]
        E4[缓存系统 CacheSystem]
        E5[日志文件 LogFiles]
    end
    
    subgraph "核心算法模块 (Core Algorithms)"
        F1[智能分配算法]
        F2[模块感知分配器]
        F3[DIDO配对器]
        F4[机架级约束处理器]
        F5[负载均衡器]
        F6[连续性优化器]
    end
    
    subgraph "生成器模块 (Generators)"
        G1[和利时PLC生成器]
        G2[安全PLC生成器]
        G3[亚控HMI生成器]
        G4[力控HMI生成器]
        G5[通讯表生成器]
        G6[FAT表生成器]
    end
    
    subgraph "文件处理模块 (File Processing)"
        H1[Excel读写器]
        H2[CSV处理器]
        H3[文本文件处理器]
        H4[配置文件管理器]
        H5[模板文件处理器]
    end
    
    subgraph "安全模块 (Security)"
        I1[身份认证]
        I2[权限验证]
        I3[会话管理]
        I4[操作审计]
        I5[数据加密]
    end
    
    %% UI层到业务逻辑层的连接
    A1 --> B1
    A1 --> B3
    A1 --> B4
    A1 --> B6
    A1 --> B7
    A1 --> B8
    A2 --> B1
    A2 --> B2
    A3 --> B3
    A4 --> B4
    A5 --> B5
    A6 --> B7
    A7 --> B3
    A7 --> B4
    A8 --> B8
    
    %% 业务逻辑层到数据处理层的连接
    B1 --> I1
    B2 --> I2
    B3 --> D2
    B4 --> D3
    B5 --> D4
    B6 --> C1
    B6 --> C2
    B6 --> D6
    B7 --> C4
    B7 --> D5
    B8 --> C5
    B8 --> C6
    
    %% 数据处理层到算法模块的连接
    C4 --> F1
    C4 --> F2
    C4 --> F3
    C4 --> F4
    C4 --> F5
    C4 --> F6
    
    %% 数据处理层到生成器模块的连接
    C5 --> G1
    C5 --> G2
    C5 --> G3
    C5 --> G4
    C5 --> G5
    C5 --> G6
    
    %% 数据处理层到文件处理模块的连接
    C1 --> H1
    C2 --> H1
    C5 --> H1
    C5 --> H2
    C5 --> H3
    C6 --> H4
    B5 --> H5
    
    %% 数据访问层到数据存储层的连接
    D1 --> E1
    D2 --> E2
    D3 --> E2
    D4 --> E3
    D5 --> E3
    D6 --> E4
    
    %% 安全模块的连接
    I1 --> D1
    I2 --> D1
    I3 --> E4
    I4 --> E5
    I5 --> E1
    
    %% 样式定义
    classDef uiLayer fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef businessLayer fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef dataLayer fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef algorithmLayer fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef generatorLayer fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    classDef fileLayer fill:#f1f8e9,stroke:#689f38,stroke-width:2px
    classDef securityLayer fill:#ffebee,stroke:#d32f2f,stroke-width:2px
    classDef storageLayer fill:#f5f5f5,stroke:#616161,stroke-width:2px
    
    class A1,A2,A3,A4,A5,A6,A7,A8 uiLayer
    class B1,B2,B3,B4,B5,B6,B7,B8 businessLayer
    class C1,C2,C3,C4,C5,C6,D1,D2,D3,D4,D5,D6 dataLayer
    class F1,F2,F3,F4,F5,F6 algorithmLayer
    class G1,G2,G3,G4,G5,G6 generatorLayer
    class H1,H2,H3,H4,H5 fileLayer
    class I1,I2,I3,I4,I5 securityLayer
    class E1,E2,E3,E4,E5 storageLayer